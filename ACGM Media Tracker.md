# ğŸ® ACGM Media Tracker

â€”â€” å¤šç±»å‹å¨±ä¹å†…å®¹æ”¶è—ä¸ç®¡ç†ç³»ç»Ÿ

## ä¸€ã€é¡¹ç›®æ¦‚è¿°

### é¡¹ç›®èƒŒæ™¯

éšç€ ACGï¼ˆAnimeã€Comicã€Gameã€Musicï¼‰æ–‡åŒ–çš„æ™®åŠï¼Œè¶Šæ¥è¶Šå¤šçš„ç”¨æˆ·åŒæ—¶æ¥è§¦å¤šç§å¨±ä¹åª’ä»‹ï¼Œå¦‚åŠ¨ç”»ã€æ¼«ç”»ã€æ¸¸æˆä¸éŸ³ä¹ã€‚
ç„¶è€Œï¼Œç›®å‰è¿™äº›å†…å®¹çš„è®°å½•ä¸ç®¡ç†å¾€å¾€åˆ†æ•£åœ¨å¤šä¸ªå¹³å°ä¸­ï¼ˆå¦‚ Bangumiã€Steamã€Spotify ç­‰ï¼‰ï¼Œç¼ºä¹ä¸€ä¸ª**ç»Ÿä¸€ã€å¯è‡ªå®šä¹‰ã€å¯æ‰©å±•çš„ä¸ªäººè®°å½•ç³»ç»Ÿ**ã€‚

æœ¬é¡¹ç›®æ—¨åœ¨å¼€å‘ä¸€ä¸ªé›†**å†…å®¹è®°å½•ã€è¿›åº¦è¿½è¸ªã€è¯„åˆ†ç»Ÿè®¡ä¸å¤–éƒ¨ä¿¡æ¯é›†æˆ**äºä¸€ä½“çš„ç»¼åˆæ€§å¨±ä¹è®°å½•ç³»ç»Ÿ â€”â€”
**ACGM Media Tracker**ï¼Œå¸®åŠ©ç”¨æˆ·åœ¨ä¸€ä¸ªå¹³å°ä¸­ç»Ÿä¸€ç®¡ç†ä¸å±•ç¤ºå„ç±»å¨±ä¹å†…å®¹ã€‚

### é¡¹ç›®ç›®æ ‡

- ä¸ºç”¨æˆ·æä¾›ä¸€ä¸ª**ç»Ÿä¸€çš„ ACGM å†…å®¹è®°å½•ä¸å±•ç¤ºä¸­å¿ƒ**ï¼›
- æ”¯æŒå¤šç±»å‹åª’ä½“å†…å®¹ï¼ˆåŠ¨ç”» / æ¼«ç”» / æ¸¸æˆ / éŸ³ä¹ï¼‰ï¼›
- å®ç°çµæ´»çš„è®°å½•ã€ç­›é€‰ã€ç»Ÿè®¡ä¸å¯è§†åŒ–åˆ†æåŠŸèƒ½ï¼›
- é›†æˆå¤–éƒ¨ APIï¼ˆå¦‚å¤©æ°”ã€ç•ªå‰§ã€æ¸¸æˆæˆ–éŸ³ä¹ä¿¡æ¯ï¼‰ä»¥ä¸°å¯Œç³»ç»Ÿå†…å®¹ï¼›
- é‡‡ç”¨**å‰åç«¯åˆ†ç¦»æ¶æ„ï¼ˆSpring Boot + Vue/Reactï¼‰**ï¼Œä¾¿äºåæœŸæ‰©å±•ä¸ç»´æŠ¤ã€‚

## äºŒã€ç³»ç»Ÿæ¶æ„ä¸åŠŸèƒ½ç»“æ„

### ç³»ç»Ÿç»“æ„ï¼ˆé€»è¾‘å±‚ï¼‰

``` txt
ç”¨æˆ·å±‚ï¼ˆå‰ç«¯å±•ç¤ºï¼‰ â†“ ä¸šåŠ¡å±‚ï¼ˆSpring Boot åç«¯æœåŠ¡ï¼‰ â†“ æ•°æ®å±‚ï¼ˆMySQL æ•°æ®åº“å­˜å‚¨ï¼‰
```

ç³»ç»Ÿé‡‡ç”¨ä¸‰å±‚æ¶æ„æ¨¡å¼ï¼Œå®ç°å‰åç«¯åˆ†ç¦»è®¾è®¡ï¼Œé€šè¿‡ RESTful API è¿›è¡Œæ•°æ®äº¤äº’ã€‚
åç«¯æä¾›ç»Ÿä¸€æ¥å£æœåŠ¡ï¼Œå‰ç«¯è´Ÿè´£ç•Œé¢äº¤äº’ä¸åŠ¨æ€æ¸²æŸ“ã€‚

### åŠŸèƒ½æ¨¡å—ç»“æ„

ç³»ç»Ÿæ•´ä½“é‡‡ç”¨æ¨¡å—åŒ–è®¾è®¡ï¼Œåˆ†ä¸ºäº”å¤§æ ¸å¿ƒæ¨¡å—ï¼š

| æ¨¡å—åç§°       | ç®€è¦è¯´æ˜                                       |      |
| -------------- | ---------------------------------------------- | ---- |
| ç”¨æˆ·æ¨¡å—       | ç®¡ç†ç”¨æˆ·è´¦æˆ·ã€èµ„æ–™ä¸åå¥½è®¾ç½®                   |      |
| å†…å®¹ç®¡ç†æ¨¡å—   | ç³»ç»Ÿæ ¸å¿ƒï¼Œç”¨äºå½•å…¥ã€æµè§ˆã€ç­›é€‰ä¸è¿½è¸ª ACGM æ¡ç›® |      |
| æ•°æ®ç»Ÿè®¡æ¨¡å—   | æä¾›å¤šç»´åº¦å¯è§†åŒ–åˆ†æä¸è¶‹åŠ¿å›¾è¡¨                 |      |
| API é›†æˆæ¨¡å—   | è°ƒç”¨ç¬¬ä¸‰æ–¹ API ä¸°å¯Œç³»ç»Ÿå†…å®¹ä¸å±•ç¤ºæ•ˆæœ          |      |
| ç®¡ç†ä¸æ‰©å±•æ¨¡å— | ç³»ç»Ÿç»´æŠ¤ã€å¤‡ä»½å¯¼å‡ºä¸åŠŸèƒ½æ‰©å±•                   |      |

---



```plaintext
ACGM Media Tracker
â”œâ”€â”€ ç”¨æˆ·æ¨¡å—ï¼ˆUser Moduleï¼‰
â”‚   â”œâ”€â”€ ç”¨æˆ·æ³¨å†Œä¸ç™»å½•ï¼ˆJWT / Sessionï¼‰
â”‚   â”œâ”€â”€ ä¸ªäººä¿¡æ¯ç®¡ç†ï¼ˆå¤´åƒã€ç­¾åã€åå¥½ï¼‰
â”‚   â”œâ”€â”€ åå¥½è®¾ç½®ï¼ˆACG åå¥½ã€é»˜è®¤å±•ç¤ºç±»å‹ï¼‰
â”‚   â””â”€â”€ æ•°æ®åŒæ­¥ä¸å¯¼å‡ºï¼ˆJSON å¤‡ä»½ / å¯¼å…¥ï¼‰
â”‚
â”œâ”€â”€ å†…å®¹ç®¡ç†æ¨¡å—ï¼ˆMedia Moduleï¼‰
â”‚   â”œâ”€â”€ å†…å®¹å½•å…¥
â”‚   â”‚   â”œâ”€â”€ æ‰‹åŠ¨å½•å…¥
â”‚   â”‚   â””â”€â”€ å¤–éƒ¨å¯¼å…¥ï¼ˆBangumi / RAWG / ç½‘æ˜“äº‘ APIï¼‰
â”‚   â”‚
â”‚   â”œâ”€â”€ å†…å®¹æµè§ˆä¸ç­›é€‰
â”‚   â”‚   â”œâ”€â”€ æµè§ˆï¼ˆåˆ†é¡µã€æ’åºã€è¯¦æƒ…é¡µï¼‰
â”‚   â”‚   â”œâ”€â”€ ç­›é€‰ï¼ˆç±»å‹ã€çŠ¶æ€ã€è¯„åˆ†ã€æ ‡ç­¾ï¼‰
â”‚   â”‚   â””â”€â”€ æœç´¢ï¼ˆæ ‡é¢˜ã€å…³é”®å­—ï¼‰
â”‚   â”‚
â”‚   â”œâ”€â”€ å†…å®¹ç¼–è¾‘ä¸åˆ é™¤
â”‚   â”‚   â”œâ”€â”€ ç¼–è¾‘ä¿¡æ¯ï¼ˆè¯„åˆ†ã€è¿›åº¦ã€çŠ¶æ€ï¼‰
â”‚   â”‚   â””â”€â”€ åˆ é™¤æ¡ç›®ï¼ˆé€»è¾‘åˆ é™¤ï¼‰
â”‚   â”‚
â”‚   â”œâ”€â”€ æ ‡ç­¾ä¸è¯„åˆ†ç³»ç»Ÿ
â”‚   â”‚   â”œâ”€â”€ è‡ªå®šä¹‰æ ‡ç­¾ï¼ˆå¤šå¯¹å¤šï¼‰
â”‚   â”‚   â””â”€â”€ ç”¨æˆ·è¯„åˆ†ï¼ˆ1â€“10 åˆ†ï¼‰
â”‚   â”‚
â”‚   â””â”€â”€ è¿›åº¦ç®¡ç†
â”‚       â”œâ”€â”€ æ¸¸æˆï¼šæ—¶é•¿ã€å®Œæˆåº¦
â”‚       â”œâ”€â”€ åŠ¨æ¼«ï¼šé›†æ•°è¿›åº¦
â”‚       â”œâ”€â”€ æ¼«ç”»ï¼šç« èŠ‚è¿›åº¦
â”‚       â””â”€â”€ éŸ³ä¹ï¼šæ’­æ”¾çŠ¶æ€ï¼ˆå·²å¬ / æœªå¬ï¼‰
â”‚
â”œâ”€â”€ æ•°æ®ç»Ÿè®¡æ¨¡å—ï¼ˆAnalytics Moduleï¼‰
â”‚   â”œâ”€â”€ å†…å®¹æ€»è§ˆç»Ÿè®¡ï¼ˆæ•°é‡ã€å®Œæˆç‡ï¼‰
â”‚   â”œâ”€â”€ ç±»å‹åˆ†å¸ƒå›¾ï¼ˆåŠ¨ç”» / æ¸¸æˆ / éŸ³ä¹æ¯”ä¾‹ï¼‰
â”‚   â”œâ”€â”€ å¹³å‡è¯„åˆ†åˆ†æï¼ˆTop æ¦œå•ï¼‰
â”‚   â”œâ”€â”€ æ—¶é—´è¶‹åŠ¿å›¾ï¼ˆæœˆåº¦æ–°å¢å†…å®¹ï¼‰
â”‚   â””â”€â”€ ç”¨æˆ·æ´»è·ƒæ•°æ®ï¼ˆå¯é€‰ï¼šè®°å½•é¢‘ç‡ã€åå¥½è¶‹åŠ¿ï¼‰
â”‚
â”œâ”€â”€ API é›†æˆæ¨¡å—ï¼ˆIntegration Moduleï¼‰
â”‚   â”œâ”€â”€ å¤©æ°”ä¿¡æ¯æ˜¾ç¤ºï¼ˆOpenWeather APIï¼‰
â”‚   â”œâ”€â”€ åŠ¨ç”» / æ¸¸æˆä¿¡æ¯å¯¼å…¥ï¼ˆBangumi / RAWGï¼‰
â”‚   â”œâ”€â”€ éŸ³ä¹å°é¢ / ä¸“è¾‘ä¿¡æ¯ï¼ˆç½‘æ˜“äº‘ / Spotifyï¼‰
â”‚   â””â”€â”€ éšæœºæ¨èæ¨¡å—ï¼ˆåŸºäºç”¨æˆ·åå¥½æˆ–å¤–éƒ¨ APIï¼‰
â”‚
â””â”€â”€ ç®¡ç†ä¸æ‰©å±•æ¨¡å—ï¼ˆAdmin & Systemï¼‰
   â”œâ”€â”€ ç®¡ç†å‘˜åå°ï¼ˆç”¨æˆ·ã€å†…å®¹ã€API æ—¥å¿—ç®¡ç†ï¼‰
   â”œâ”€â”€ æ•°æ®å¯¼å‡º / å¤‡ä»½ï¼ˆJSON / CSV / PDFï¼‰
   â”œâ”€â”€ ç³»ç»Ÿé…ç½®ï¼ˆä¸»é¢˜ã€ç¼“å­˜ã€æ—¥å¿—ï¼‰
   â””â”€â”€ å¼€å‘è€…æ‰©å±•ï¼ˆé¢„ç•™ APIã€æ’ä»¶æ¥å£ï¼‰
```

## åŠŸèƒ½æ¨¡å—è¯´æ˜

### ç”¨æˆ·æ¨¡å—

| åŠŸèƒ½           | æè¿°                       | æŠ€æœ¯è¦ç‚¹                 |      |
| -------------- | -------------------------- | ------------------------ | ---- |
| ç”¨æˆ·æ³¨å†Œä¸ç™»å½• | æ”¯æŒé‚®ç®±æˆ–ç”¨æˆ·åæ³¨å†Œç™»å½•   | JWT è®¤è¯ã€BCrypt åŠ å¯†    |      |
| ä¸ªäººä¿¡æ¯ç®¡ç†   | ä¿®æ”¹å¤´åƒã€æ˜µç§°ã€ç­¾åã€åå¥½ | æ–‡ä»¶ä¸Šä¼ ã€æ•°æ®åº“æ›´æ–°     |      |
| åå¥½è®¾ç½®       | è®¾ç½®é»˜è®¤å±•ç¤ºç±»å‹ã€ä¸»é¢˜æ¨¡å¼ | ç”¨æˆ·è¡¨å­—æ®µå­˜å‚¨ JSON é…ç½® |      |
| æ•°æ®å¤‡ä»½ä¸å¯¼å…¥ | å¯¼å‡º/å¯¼å…¥ç”¨æˆ·åª’ä½“æ•°æ®      | JSON æ–‡ä»¶æ‰“åŒ…ä¸è§£æ      |      |

### å†…å®¹ç®¡ç†æ¨¡å—ï¼ˆæ ¸å¿ƒï¼‰

| åŠŸèƒ½       | æè¿°                                | æŠ€æœ¯è¦ç‚¹                    |
| ---------- | ----------------------------------- | --------------------------- |
| å†…å®¹å½•å…¥   | ç”¨æˆ·æ‰‹åŠ¨å½•å…¥æˆ–é€šè¿‡å¤–éƒ¨ API å¯¼å…¥æ¡ç›® | è¡¨å•æäº¤ / å¤–éƒ¨æ¥å£è°ƒç”¨     |
| å†…å®¹æµè§ˆ   | åˆ†é¡µå±•ç¤ºå†…å®¹ï¼Œæ”¯æŒæ’åºä¸è¯¦æƒ…é¡µæŸ¥çœ‹  | åç«¯åˆ†é¡µæŸ¥è¯¢                |
| ç­›é€‰ä¸æœç´¢ | æŒ‰ç±»å‹ã€çŠ¶æ€ã€æ ‡ç­¾ã€è¯„åˆ†ç­‰ç­›é€‰      | RESTful å‚æ•°è¿‡æ»¤            |
| ç¼–è¾‘ä¸åˆ é™¤ | ä¿®æ”¹æ¡ç›®ä¿¡æ¯æˆ–é€»è¾‘åˆ é™¤              | CRUD æ“ä½œã€è½¯åˆ é™¤æ ‡è®°       |
| æ ‡ç­¾ç®¡ç†   | ç”¨æˆ·è‡ªå®šä¹‰æ ‡ç­¾å¹¶ä¸æ¡ç›®å…³è”          | å¤šå¯¹å¤šå…³ç³»è¡¨                |
| è¿›åº¦ç®¡ç†   | ä¸åŒç±»å‹å¯¹åº”ä¸åŒè¿›åº¦æ ¼å¼            | å¤šæ€æ˜ å°„è®¾è®¡ï¼ˆç« èŠ‚ / æ—¶é•¿ï¼‰ |

### æ•°æ®ç»Ÿè®¡æ¨¡å—

| åŠŸèƒ½                 | æè¿°                   | å±•ç¤ºæ–¹å¼      |
| -------------------- | ---------------------- | ------------- |
| å†…å®¹æ€»è§ˆç»Ÿè®¡         | æ±‡æ€»æ¡ç›®æ€»æ•°ã€å®Œæˆç‡   | é¥¼å›¾ / æŸ±çŠ¶å›¾ |
| ç±»å‹åˆ†å¸ƒåˆ†æ         | å„åª’ä½“ç±»å‹å æ¯”         | ç¯å½¢å›¾        |
| å¹³å‡è¯„åˆ†ä¸æ¦œå•       | å±•ç¤ºæœ€é«˜è¯„åˆ† Top æ¡ç›®  | æ¡å½¢å›¾        |
| æ—¶é—´è¶‹åŠ¿ç»Ÿè®¡         | æ¯æœˆæ–°å¢å†…å®¹å˜åŒ–è¶‹åŠ¿   | æŠ˜çº¿å›¾        |
| ç”¨æˆ·ä½¿ç”¨æ•°æ®ï¼ˆå¯é€‰ï¼‰ | åˆ†æè®°å½•é¢‘ç‡ã€åå¥½å€¾å‘ | æŠ˜çº¿ / åŒºåŸŸå›¾ |

> ä½¿ç”¨ ECharts å®ç°å¯è§†åŒ–æ•ˆæœï¼Œåç«¯ç»Ÿè®¡è®¡ç®—åè¿”å› JSON æ•°æ®ã€‚

### API é›†æˆæ¨¡å—

| æ¨¡å—                | æè¿°                       | æ•°æ®æ¥æº                |
| ------------------- | -------------------------- | ----------------------- |
| å¤©æ°”ä¿¡æ¯æ˜¾ç¤º        | å±•ç¤ºå½“å‰åŸå¸‚å¤©æ°”ã€æ¸©åº¦     | OpenWeather API         |
| åŠ¨ç”» / æ¸¸æˆä¿¡æ¯å¯¼å…¥ | è‡ªåŠ¨æ‹‰å–æ¡ç›®ä¿¡æ¯ä¸å°é¢     | Bangumi / RAWG          |
| éŸ³ä¹å°é¢æŸ¥è¯¢        | è·å–æ­Œæ›²å°é¢ä¸ä¸“è¾‘ä¿¡æ¯     | ç½‘æ˜“äº‘ / Spotify API    |
| éšæœºæ¨èæ¨¡å—        | æ ¹æ®åå¥½æˆ–çƒ­é—¨æ•°æ®éšæœºæ¨è | æœ¬åœ°ç®—æ³• / API æ•°æ®èåˆ |

### ç®¡ç†ä¸æ‰©å±•æ¨¡å—ï¼ˆå¯é€‰ï¼‰

- **ç³»ç»Ÿè®¾ç½®**ï¼šå¤œé—´æ¨¡å¼ã€ä¸»é¢˜åˆ‡æ¢ã€ç¼“å­˜åˆ·æ–°ã€‚
- **å¯¼å‡ºæŠ¥å‘Š**ï¼šå¯ç”Ÿæˆå¹´åº¦å¨±ä¹æ€»ç»“æŠ¥å‘Šï¼ˆPDF / CSVï¼‰ã€‚
- **ç®¡ç†å‘˜åå°**ï¼šç®¡ç†ç”¨æˆ·ä¸æ•°æ®ã€æŸ¥çœ‹æ—¥å¿—ã€‚
- **å¼€å‘æ‰©å±•æ¥å£**ï¼šé¢„ç•™æ’ä»¶æˆ–ç§»åŠ¨ç«¯åŒæ­¥æ”¯æŒã€‚

## æ•°æ®åº“è®¾è®¡

### â‘  users è¡¨ â€” ç”¨æˆ·ä¿¡æ¯è¡¨ï¼ˆæ ¸å¿ƒç”¨æˆ·æ•°æ®ï¼‰

| å­—æ®µå                               | ç±»å‹         | çº¦æŸ                                 | è¯´æ˜                                 |
| ------------------------------------ | ------------ | ------------------------------------ | ------------------------------------ |
| id                                   | BIGINT       | PK, AUTO_INCREMENT                   | ç”¨æˆ·ä¸»é”®                             |
| username                             | VARCHAR(32)  | UNIQUE, NOT NULL                     | ç”¨æˆ·å                               |
| password                             | VARCHAR(128) | NOT NULL                             | åŠ å¯†å¯†ç ï¼ˆBCryptï¼‰                   |
| email                                | VARCHAR(64)  | UNIQUE, NOT NULL                     | é‚®ç®±                                 |
| avatar_url                           | VARCHAR(255) | DEFAULT NULL                         | å¤´åƒåœ°å€                             |
| signature                            | VARCHAR(100) | DEFAULT NULL                         | ä¸ªæ€§ç­¾å                             |
| preference                           | JSON         | DEFAULT NULL                         | ç”¨æˆ·åå¥½ï¼ˆé»˜è®¤å±•ç¤ºç±»å‹ã€ä¸»é¢˜è®¾ç½®ç­‰ï¼‰ |
| role                                 | VARCHAR(20)  | DEFAULT 'user'                       | ç”¨æˆ·è§’è‰²ï¼ˆuser/adminï¼‰               |
| created_at / updated_at / deleted_at | DATETIME     | (ON UPDATE)DEFAULT CURRENT_TIMESTAMP | åˆ›å»ºæ›´æ–°åˆ é™¤æ—¶é—´                     |

**ç´¢å¼•ï¼š**

- `idx_user_username`
- `idx_user_email`

### â‘¡ media_items è¡¨ â€” ACGM å†…å®¹ä¸»è¡¨ï¼ˆç³»ç»Ÿæ ¸å¿ƒï¼‰

| å­—æ®µå                             | ç±»å‹                                                   | çº¦æŸ                                 | è¯´æ˜                   |
| ---------------------------------- | ------------------------------------------------------ | ------------------------------------ | ---------------------- |
| id                                 | BIGINT                                                 | PK, AUTO_INCREMENT                   | æ¡ç›®ä¸»é”®               |
| user_id                            | BIGINT                                                 | FK â†’ users(id)                       | æ‰€å±ç”¨æˆ·               |
| title                              | VARCHAR(128)                                           | NOT NULL                             | å†…å®¹æ ‡é¢˜               |
| type                               | ENUM('anime','comic','game','music')                   | NOT NULL                             | å†…å®¹ç±»å‹               |
| status                             | ENUM('not_started','in_progress','completed','paused') | DEFAULT 'not_started'                | çŠ¶æ€                   |
| rating                             | DECIMAL(3,1)                                           | DEFAULT NULL                         | ç”¨æˆ·è¯„åˆ†ï¼ˆ1â€“10ï¼‰       |
| platform                           | VARCHAR(64)                                            | DEFAULT NULL                         | æ¥æºå¹³å°               |
| start_date                         | DATE                                                   | DEFAULT NULL                         | å¼€å§‹æ—¶é—´               |
| finish_date                        | DATE                                                   | DEFAULT NULL                         | å®Œæˆæ—¶é—´               |
| cover_url                          | VARCHAR(255)                                           | DEFAULT NULL                         | å°é¢é“¾æ¥               |
| notes                              | TEXT                                                   | DEFAULT NULL                         | å¤‡æ³¨ / ç®€è¯„            |
| source                             | VARCHAR(16)                                            | DEFAULT 'manual'                     | æ•°æ®æ¥æºï¼ˆmanual/apiï¼‰ |
| created_at/ updated_at/ deleted_at | DATETIME                                               | (ON UPDATE)DEFAULT CURRENT_TIMESTAMP | åˆ›å»ºæ›´æ–°åˆ é™¤æ—¶é—´       |

**ç´¢å¼•ï¼š**

- `idx_media_user_type`
- `idx_media_status`
- `idx_media_rating`

**çº¦æŸï¼š**

- `FK_media_user` å¤–é”®ï¼šuser_id â†’ users.idï¼ˆON DELETE CASCADEï¼‰

#### progress_anime è¡¨ â€” åŠ¨ç”»è¿›åº¦è¡¨ï¼ˆ1:1 å…³è”ï¼‰

| å­—æ®µå          | ç±»å‹   | çº¦æŸ                     | è¯´æ˜                            |
| --------------- | ------ | ------------------------ | ------------------------------- |
| media_id        | BIGINT | PK, FK â†’ media_items(id) | æ¡ç›®ä¸»é”®ï¼ˆä¸ media_items å…³è”ï¼‰ |
| current_episode | INT    | DEFAULT 0                | å½“å‰é›†æ•°                        |
| total_episodes  | INT    | DEFAULT NULL             | æ€»é›†æ•°ï¼ˆæœªçŸ¥æ—¶ä¸º NULLï¼‰         |

**å¤–é”®çº¦æŸï¼š**

- `FK_progress_anime_media` å¤–é”®ï¼šmedia_id â†’ media_items.idï¼ˆON DELETE CASCADEï¼‰

#### progress_comic è¡¨ â€” æ¼«ç”»è¿›åº¦è¡¨ï¼ˆ1:1 å…³è”ï¼‰

| å­—æ®µå          | ç±»å‹   | çº¦æŸ                     | è¯´æ˜                            |
| --------------- | ------ | ------------------------ | ------------------------------- |
| media_id        | BIGINT | PK, FK â†’ media_items(id) | æ¡ç›®ä¸»é”®ï¼ˆä¸ media_items å…³è”ï¼‰ |
| current_chapter | INT    | DEFAULT 0                | å½“å‰ç« èŠ‚                        |
| total_chapters  | INT    | DEFAULT NULL             | æ€»ç« èŠ‚æ•°                        |
| current_volume  | INT    | DEFAULT NULL             | å½“å‰å·æ•°ï¼ˆå¯é€‰ï¼‰                |

**å¤–é”®çº¦æŸï¼š**

- `FK_progress_comic_media` å¤–é”®ï¼šmedia_id â†’ media_items.idï¼ˆON DELETE CASCADEï¼‰

#### progress_game è¡¨ â€” æ¸¸æˆè¿›åº¦è¡¨ï¼ˆ1:1 å…³è”ï¼‰

| å­—æ®µå             | ç±»å‹          | çº¦æŸ                     | è¯´æ˜                            |
| ------------------ | ------------- | ------------------------ | ------------------------------- |
| media_id           | BIGINT        | PK, FK â†’ media_items(id) | æ¡ç›®ä¸»é”®ï¼ˆä¸ media_items å…³è”ï¼‰ |
| play_hours         | DECIMAL(7, 1) | DEFAULT 0.0              | æ¸¸ç©æ—¶é•¿ï¼ˆä¾‹å¦‚ 40.5 å°æ—¶ï¼‰      |
| completion_percent | INT           | DEFAULT 0                | å®Œæˆåº¦ï¼ˆ0-100ï¼‰                 |
| custom_status      | VARCHAR(100)  | DEFAULT NULL             | è‡ªå®šä¹‰è¿›åº¦ï¼ˆå¦‚ "ç™½é‡‘ä¸­"ï¼‰       |

**å¤–é”®çº¦æŸï¼š**

- `FK_progress_game_media` å¤–é”®ï¼šmedia_id â†’ media_items.idï¼ˆON DELETE CASCADEï¼‰

#### progress_music è¡¨ â€” éŸ³ä¹è¿›åº¦è¡¨ï¼ˆ1:1 å…³è”ï¼‰

| å­—æ®µå        | ç±»å‹                                    | çº¦æŸ                     | è¯´æ˜                            |
| ------------- | --------------------------------------- | ------------------------ | ------------------------------- |
| media_id      | BIGINT                                  | PK, FK â†’ media_items(id) | æ¡ç›®ä¸»é”®ï¼ˆä¸ media_items å…³è”ï¼‰ |
| listen_status | ENUM('listened', 'listened', 'partial') | DEFAULT 'unheard'        | æ’­æ”¾çŠ¶æ€                        |
| play_count    | INT                                     | DEFAULT 0                | æ’­æ”¾æ¬¡æ•°                        |

**å¤–é”®çº¦æŸï¼š**

- `FK_progress_music_media` å¤–é”®ï¼šmedia_id â†’ media_items.idï¼ˆON DELETE CASCADEï¼‰

### â‘¢ tags è¡¨ â€” æ ‡ç­¾å®šä¹‰è¡¨

| å­—æ®µå    | ç±»å‹        | çº¦æŸ                      | è¯´æ˜         |
| --------- | ----------- | ------------------------- | ------------ |
| id        | BIGINT      | PK, AUTO_INCREMENT        | æ ‡ç­¾ä¸»é”®     |
| user_id   | BIGINT      | FK â†’ users(id)            | æ‰€å±ç”¨æˆ·     |
| name      | VARCHAR(50) | NOT NULL                  | æ ‡ç­¾åç§°     |
| color     | VARCHAR(16) | DEFAULT '#999999'         | æ ‡ç­¾æ˜¾ç¤ºé¢œè‰² |
| create_at | DATETIME    | DEFAULT CURRENT_TIMESTAMP | åˆ›å»ºæ—¶é—´     |

**ç´¢å¼•ï¼š**

- `idx_tag_user_name`ï¼ˆuser_id, nameï¼‰

### â‘£ media_tag_rel è¡¨ â€” å†…å®¹ä¸æ ‡ç­¾çš„å¤šå¯¹å¤šå…³ç³»è¡¨

| å­—æ®µå      | ç±»å‹     | çº¦æŸ                      | è¯´æ˜     |
| ----------- | -------- | ------------------------- | -------- |
| media_id    | BIGINT   | FK â†’ media_items(id)      | å†…å®¹ ID  |
| tag_id      | BIGINT   | FK â†’ tags(id)             | æ ‡ç­¾ ID  |
| create_time | DATETIME | DEFAULT CURRENT_TIMESTAMP | åˆ›å»ºæ—¶é—´ |

**å¤åˆä¸»é”®ï¼š** `(media_id, tag_id)`
**å¤–é”®çº¦æŸï¼š**

- `FK_media_tag_media`ï¼šON DELETE CASCADE
- `FK_media_tag_tag`ï¼šON DELETE CASCADE

### â‘¤ reviews è¡¨ â€” å†…å®¹è¯„è®º / ç®€è¯„è¡¨ï¼ˆæ‰©å±•ï¼‰

| å­—æ®µå      | ç±»å‹         | çº¦æŸ                        | è¯´æ˜                     |
| ----------- | ------------ | --------------------------- | ------------------------ |
| id          | BIGINT       | PK, AUTO_INCREMENT          | è¯„è®ºä¸»é”®                 |
| user_id     | BIGINT       | FK â†’ users(id)              | è¯„è®ºç”¨æˆ·                 |
| media_id    | BIGINT       | FK â†’ media_items(id)        | è¯„è®ºæ¡ç›®                 |
| rating      | DECIMAL(3,1) | DEFAULT NULL                | äºŒæ¬¡è¯„åˆ†ï¼ˆä¸ä¸»è¯„åˆ†åˆ†ç¦»ï¼‰ |
| content     | TEXT         | NOT NULL                    | è¯„è®ºå†…å®¹                 |
| create_time | DATETIME     | DEFAULT CURRENT_TIMESTAMP   | åˆ›å»ºæ—¶é—´                 |
| update_time | DATETIME     | ON UPDATE CURRENT_TIMESTAMP | æ›´æ–°æ—¶é—´                 |

**ç´¢å¼•ï¼š**

- `idx_review_media`
- `idx_review_user_media`

### â‘¥ favorites è¡¨ â€” ç”¨æˆ·æ”¶è—è¡¨ï¼ˆé€‰åšï¼‰

| å­—æ®µå      | ç±»å‹         | çº¦æŸ                      | è¯´æ˜     |
| ----------- | ------------ | ------------------------- | -------- |
| id          | BIGINT       | PK, AUTO_INCREMENT        | æ”¶è—ä¸»é”® |
| user_id     | BIGINT       | FK â†’ users(id)            | ç”¨æˆ· ID  |
| media_id    | BIGINT       | FK â†’ media_items(id)      | æ”¶è—æ¡ç›® |
| remark      | VARCHAR(255) | DEFAULT NULL              | æ”¶è—å¤‡æ³¨ |
| create_time | DATETIME     | DEFAULT CURRENT_TIMESTAMP | æ”¶è—æ—¶é—´ |

**å¤åˆå”¯ä¸€çº¦æŸï¼š** `(user_id, media_id)`

### â‘¦ media_api_info è¡¨ â€” å¤–éƒ¨APIä¿¡æ¯è¡¨ï¼ˆç¼“å­˜ç”¨ï¼‰

| å­—æ®µå     | ç±»å‹        | çº¦æŸ                      | è¯´æ˜                       |
| ---------- | ----------- | ------------------------- | -------------------------- |
| id         | BIGINT      | PK, AUTO_INCREMENT        | ä¸»é”®                       |
| media_id   | BIGINT      | FK â†’ media_items(id)      | å¯¹åº”æœ¬åœ°å†…å®¹               |
| api_source | VARCHAR(50) | NOT NULL                  | APIæ¥æºï¼ˆBangumiã€RAWGç­‰ï¼‰ |
| api_id     | VARCHAR(50) | DEFAULT NULL              | å¯¹åº”APIçš„å”¯ä¸€ID            |
| api_json   | JSON        | DEFAULT NULL              | åŸå§‹APIå“åº”æ•°æ®ï¼ˆç¼“å­˜ï¼‰    |
| last_sync  | DATETIME    | DEFAULT CURRENT_TIMESTAMP | æœ€è¿‘åŒæ­¥æ—¶é—´               |

## è¡¨é—´å…³ç³»æ€»ç»“

| å…³ç³»ç±»å‹ | å®ä½“å…³ç³»                             | æè¿°                 |
| -------- | ------------------------------------ | -------------------- |
| ä¸€å¯¹å¤š   | users â†’ media_items                  | ä¸€ä¸ªç”¨æˆ·æ‹¥æœ‰å¤šä¸ªæ¡ç›® |
| ä¸€å¯¹å¤š   | users â†’ tags                         | ä¸€ä¸ªç”¨æˆ·å®šä¹‰å¤šä¸ªæ ‡ç­¾ |
| å¤šå¯¹å¤š   | media_items â†” tags                   | æ¡ç›®å¯æœ‰å¤šä¸ªæ ‡ç­¾     |
| ä¸€å¯¹å¤š   | media_items â†’ reviews                | æ¡ç›®å¯æœ‰å¤šä¸ªè¯„è®º     |
| å¤šå¯¹å¤š   | users â†” media_itemsï¼ˆvia favoritesï¼‰ | ç”¨æˆ·å¯æ”¶è—å¤šä¸ªæ¡ç›®   |
| ä¸€å¯¹ä¸€   | media_items â†’ progress_anime         | åŠ¨ç”»è¿›åº¦ï¼ˆ1:1 å…³è”ï¼‰ |
| ä¸€å¯¹ä¸€   | media_items â†’ progress_comic         | æ¼«ç”»è¿›åº¦ï¼ˆ1:1 å…³è”ï¼‰ |
| ä¸€å¯¹ä¸€   | media_items â†’ progress_game          | æ¸¸æˆè¿›åº¦ï¼ˆ1:1 å…³è”ï¼‰ |
| ä¸€å¯¹ä¸€   | media_items â†’ progress_music         | éŸ³ä¹è¿›åº¦ï¼ˆ1:1 å…³è”ï¼‰ |

### æ•°æ®ç¤ºä¾‹ï¼ˆç®€è¦ï¼‰

**users** è¡¨

| id   | username | email                                   | preference                              |
| ---- | -------- | --------------------------------------- | --------------------------------------- |
| 1    | Alice    | [alice@demo.com](mailto:alice@demo.com) | {"theme":"dark","default_type":"anime"} |

**media_items** è¡¨

| id   | user_id | title                    | type  | status      | rating |
| ---- | ------- | ------------------------ | ----- | ----------- | ------ |
| 1    | 1       | ã€Šè¿›å‡»çš„å·¨äººã€‹           | anime | completed   | 9.5    |
| 2    | 1       | ã€Šå¡å°”è¾¾ä¼ è¯´ï¼šæ—·é‡ä¹‹æ¯ã€‹ | game  | in_progress | 9.0    |

**progress_anime** è¡¨

| media_id | current_episode | total_episodes |
| -------- | --------------- | -------------- |
| 1        | 87              | 87             |

**tags** è¡¨

| id   | user_id | name | color                                          |
| ---- | ------- | ---- | ---------------------------------------------- |
| 1    | 1       | çƒ­è¡€ | [#FF5555](app://obsidian.md/index.html#FF5555) |
| 2    | 1       | å†’é™© | [#66CCFF](app://obsidian.md/index.html#66CCFF) |

**media_tag_rel** è¡¨

| media_id | tag_id |
| -------- | ------ |
| 1        | 1      |
| 1        | 2      |

## æ¥å£æ¦‚è¦è®¾è®¡ï¼ˆRESTfulï¼‰

| åŠŸèƒ½         | Method          | Endpoint            | è¯´æ˜             |
| ------------ | --------------- | ------------------- | ---------------- |
| æ³¨å†Œ         | POST            | /api/users/register | åˆ›å»ºç”¨æˆ·         |
| ç™»å½•         | POST            | /api/users/login    | è·å– JWT         |
| è·å–ç”¨æˆ·ä¿¡æ¯ | GET             | /api/users/me       | è¿”å›ä¸ªäººèµ„æ–™     |
| æ·»åŠ å†…å®¹     | POST            | /api/media          | åˆ›å»ºå†…å®¹æ¡ç›®     |
| è·å–å†…å®¹     | GET             | /api/media          | æ”¯æŒåˆ†é¡µä¸ç­›é€‰   |
| ä¿®æ”¹å†…å®¹     | PUT             | /api/media/{id}     | æ›´æ–°æ¡ç›®ä¿¡æ¯     |
| åˆ é™¤å†…å®¹     | DELETE          | /api/media/{id}     | é€»è¾‘åˆ é™¤         |
| è·å–ç»Ÿè®¡æ•°æ® | GET             | /api/stats          | è¿”å›æ•°æ®åˆ†æç»“æœ |
| æ ‡ç­¾ç®¡ç†     | GET/POST/DELETE | /api/tags           | æ ‡ç­¾å¢åˆ æŸ¥       |

## æ ¸å¿ƒ API è¯¦ç»†è®¾è®¡ï¼ˆå†…å®¹ç®¡ç†ï¼‰

### æ¥å£ 1: åˆ›å»ºå†…å®¹æ¡ç›®ï¼ˆæ·»åŠ æ–°è®°å½•ï¼‰

è¯¥æ¥å£ç”¨äºç”¨æˆ·å‘ç³»ç»Ÿä¸­æ·»åŠ ä¸€ä¸ªæ–°çš„ ACGM è®°å½•ã€‚

| **åŠŸèƒ½**     | **Method** | **Endpoint** | **è¯´æ˜**                                           | **æ•°æ®åº“æ“ä½œ**                                               |
| ------------ | ---------- | ------------ | -------------------------------------------------- | ------------------------------------------------------------ |
| **åˆ›å»ºå†…å®¹** | **POST**   | `/api/media` | åˆ›å»ºä¸€ä¸ªæ–°å†…å®¹æ¡ç›®ï¼Œå¹¶åŒæ—¶åˆ›å»ºå¯¹åº”çš„è¿›åº¦å­è¡¨è®°å½•ã€‚ | **äº‹åŠ¡æ€§æ“ä½œ**ï¼š`media_items` (INSERT) + `progress_*` (INSERT) |

#### è¯·æ±‚ä½“ (Request Body) DTO ç»“æ„

ç”±äºè¿›åº¦ä¿¡æ¯æ˜¯åŠ¨æ€çš„ï¼ˆå–å†³äº `type`ï¼‰ï¼Œæˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªé€šç”¨çš„åµŒå¥—å¯¹è±¡ `progress_info` æ¥ä¼ é€’æ•°æ®ã€‚

| **å­—æ®µå**          | **ç±»å‹**     | **çº¦æŸ** | **ç¤ºä¾‹å€¼**            | **è¯´æ˜**                                   |
| ------------------- | ------------ | -------- | --------------------- | ------------------------------------------ |
| `title`             | `String`     | å¿…éœ€     | `"èµ›åšæœ‹å…‹ 2077"`     | å†…å®¹æ ‡é¢˜                                   |
| `type`              | `String`     | å¿…éœ€     | `"game"`              | å†…å®¹ç±»å‹ï¼ˆ`anime`/`comic`/`game`/`music`ï¼‰ |
| `status`            | `String`     | å¿…éœ€     | `"in_progress"`       | å½“å‰çŠ¶æ€                                   |
| `rating`            | `Number`     | å¯é€‰     | `8.5`                 | ç”¨æˆ·è¯„åˆ†                                   |
| `platform`          | `String`     | å¯é€‰     | `"Steam"`             | æ¥æºå¹³å°                                   |
| `notes`             | `String`     | å¯é€‰     | `"å¤œä¹‹åŸå¤ªè¿·äººäº†..."` | å¤‡æ³¨ / ç®€è¯„                                |
| `cover_url`         | `String`     | å¯é€‰     | `http://.../img.jpg`  | å°é¢é“¾æ¥                                   |
| **`progress_info`** | **`Object`** | **å¿…éœ€** | *è§ä¸‹æ–¹*              | **åŠ¨æ€è¿›åº¦æ•°æ®ï¼ˆæ ¸å¿ƒï¼‰**                   |

**`progress_info` åŠ¨æ€ç»“æ„ç¤ºä¾‹ï¼š**

| **ç±»å‹ (type)** | **progress_info ç»“æ„ç¤ºä¾‹ (Game)**                            | **progress_info ç»“æ„ç¤ºä¾‹ (Anime)**                           |
| --------------- | ------------------------------------------------------------ | ------------------------------------------------------------ |
| **`game`**      | `{ "play_hours": 45.3, "completion_percent": 60, "custom_status": "ä¸»çº¿å·²é€š" }` |                                                              |
| **`anime`**     |                                                              | `{ "current_episode": 10, "total_episodes": 12 }`            |
| **`comic`**     |                                                              | `{ "current_chapter": 200, "total_chapters": 250, "current_volume": 18 }` |
| **`music`**     |                                                              | `{ "listen_status": "Listened", "play_count": 5 }`           |

#### å“åº”ä½“ (Response Body) DTO ç»“æ„

æˆåŠŸåˆ›å»ºåï¼Œè¿”å›åŒ…å«æ–°ç”Ÿæˆçš„ `id` åœ¨å†…çš„å®Œæ•´æ¡ç›®æ•°æ®ã€‚



``` JSON
{
  "code": 201, // HTTP 201 Created
  "message": "å†…å®¹æ¡ç›®åˆ›å»ºæˆåŠŸ",
  "data": {
    "id": 1001,
    "title": "èµ›åšæœ‹å…‹ 2077",
    "type": "game",
    "status": "in_progress",
    "rating": 8.5,
    // ... å…¶å®ƒé€šç”¨å­—æ®µ
    "progress_info": { // åŒ…å«åˆ›å»ºæˆåŠŸçš„è¿›åº¦æ•°æ®
      "play_hours": 45.3,
      "completion_percent": 60
    },
    "create_time": "2025-11-05T09:30:00Z"
  }
}
```

### 6.2. æ¥å£ 2: è·å–å†…å®¹åˆ—è¡¨ï¼ˆåˆ†é¡µã€ç­›é€‰ä¸æ’åºï¼‰

è¯¥æ¥å£æ˜¯ç”¨æˆ·æŸ¥çœ‹è‡ªå·±æ”¶è—åˆ—è¡¨çš„æ ¸å¿ƒæ¥å£ï¼Œå¤æ‚åº¦æœ€é«˜ã€‚

| **åŠŸèƒ½**     | **Method** | **Endpoint** | **è¯´æ˜**                               | **æ•°æ®åº“æ“ä½œ**                                               |
| ------------ | ---------- | ------------ | -------------------------------------- | ------------------------------------------------------------ |
| **è·å–åˆ—è¡¨** | **GET**    | `/api/media` | è·å–ç”¨æˆ·çš„å†…å®¹åˆ—è¡¨ï¼Œæ”¯æŒå¤šç§æŸ¥è¯¢å‚æ•°ã€‚ | `media_items` (SELECT) + **åŠ¨æ€ JOIN** `progress_*` (SELECT) |

#### è¯·æ±‚å‚æ•° (Request Query Parameters)

| **å‚æ•°å**    | **ç±»å‹**  | **çº¦æŸ** | **ç¤ºä¾‹å€¼**         | **å¤‡æ³¨**                         |
| ------------- | --------- | -------- | ------------------ | -------------------------------- |
| `type`        | `String`  | å¯é€‰     | `anime`            | å†…å®¹ç±»å‹ç­›é€‰                     |
| `status`      | `String`  | å¯é€‰     | `completed`        | çŠ¶æ€ç­›é€‰                         |
| `tags`        | `String`  | å¯é€‰     | `å†’é™©,çƒ­è¡€`        | æ ‡ç­¾ç­›é€‰ï¼ˆé€—å·åˆ†éš”ï¼‰             |
| `rating_min`  | `Number`  | å¯é€‰     | `8.0`              | æœ€å°è¯„åˆ†                         |
| **`sort_by`** | `String`  | å¯é€‰     | `finish_date,desc` | **æ’åºå­—æ®µå’Œé¡ºåº** (`å­—æ®µ,æ–¹å‘`) |
| `keyword`     | `String`  | å¯é€‰     | `EVA`              | æ ‡é¢˜/å¤‡æ³¨æ¨¡ç³Šæœç´¢                |
| `page`        | `Integer` | å¿…éœ€     | `1`                | å½“å‰é¡µç  (é»˜è®¤ 1)                |
| `size`        | `Integer` | å¿…éœ€     | `20`               | æ¯é¡µæ•°é‡ (é»˜è®¤ 20)               |

#### å“åº”ä½“ (Response Body) DTO ç»“æ„

è¿”å›ä¸€ä¸ªæ ‡å‡†çš„åˆ†é¡µç»“æ„ï¼Œåˆ—è¡¨ä¸­çš„æ¯ä¸ªæ¡ç›®éƒ½åŒ…å«äº†å…¶åŠ¨æ€è¿›åº¦ä¿¡æ¯ã€‚


``` JSON
{
  "code": 200,
  "message": "æŸ¥è¯¢æˆåŠŸ",
  "data": {
    "total_count": 123, // æ€»æ¡ç›®æ•°
    "total_pages": 7,   // æ€»é¡µæ•°
    "current_page": 1,
    "items": [
      {
        "id": 1001,
        "title": "èµ›åšæœ‹å…‹ 2077",
        "type": "game",
        "status": "in_progress",
        "rating": 8.5,
        "tags": ["èµ›åšæœ‹å…‹", "å¼€æ”¾ä¸–ç•Œ"], // é¢å¤– JOIN å‡ºæ¥çš„æ ‡ç­¾åˆ—è¡¨
        "progress_info": { // åŠ¨æ€åŠ è½½çš„æ¸¸æˆè¿›åº¦
          "play_hours": 45.3,
          "completion_percent": 60
        }
      },
      {
        "id": 1002,
        "title": "è¿›å‡»çš„å·¨äºº",
        "type": "anime",
        "status": "completed",
        "rating": 9.5,
        "tags": ["çƒ­è¡€", "è‡´éƒ"],
        "progress_info": { // åŠ¨æ€åŠ è½½çš„åŠ¨ç”»è¿›åº¦
          "current_episode": 87,
          "total_episodes": 87
        }
      }
      // ... æ›´å¤šæ¡ç›®
    ]
  }
}
```
